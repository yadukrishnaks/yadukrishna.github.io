<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>HS Checklist</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>

<div class="container-fluid vh-100">
  <div class="row h-100">

    <!-- MAIN -->
    <div class="col-md-9 p-4 overflow-auto">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="fw-bold mb-0">HS Work Checklist</h2>
        <span class="badge bg-dark fs-6">⏱ <span id="timer">00:00:00</span></span>
      </div>

      <!-- PROGRESS -->
      <div class="mb-4">
        <div class="d-flex justify-content-between mb-1">
          <small>Progress</small>
          <small id="progressText">0%</small>
        </div>
        <div class="progress">
          <div id="progressBar" class="progress-bar bg-success" style="width:0%"></div>
        </div>
      </div>

      <div id="checklist"></div>

      <div class="mt-4">
        <button id="toggleAllBtn" class="btn btn-primary me-2">Select All</button>
        <button id="nextBtn" class="btn btn-success me-2" disabled>Done – Go to Self QC</button>
        <button onclick="location.href='index.html'" class="btn btn-outline-secondary me-2">Back</button>
        <button onclick="resetAll()" class="btn btn-outline-danger">Reset</button>
      </div>
    </div>

    <!-- NOTES -->
    <div class="col-md-3 p-4 notes-area">
      <h5 class="fw-bold mb-3">Notes / Reminders</h5>
      <textarea id="notes" class="form-control h-100"
        placeholder="Tap models, jumps, special instructions..."></textarea>
    </div>

  </div>
</div>

<script>
/* ========= CHECKLIST DATA ========= */
const checklistData = [
   /* ===== PRISM ===== */
  {
    title: "PRISM",
    items: [
      "Assign designer",
      "Download walkout from documents"
    ]
  },

  /* ===== MQMS – ROUTE ===== */
  {
    title: "MQMS – ROUTE",
    items: [
      "Run clock in ROUTE"
    ]
  },

  /* ===== MAGELLAN ===== */
  {
    title: "MAGELLAN",
    items: [
      "Create workspace"
    ]
  },

  /* ===== ROUTE PHASE ===== */
  {
    title: "ROUTE PHASE – Drafting & Analysis",
    items: [
      "Match walkout in Magellan",
      "Verify strand, pole, address, tag details",
      "Verify coax equipment and manufacturer",
      "Review overall drafting (avoid overstriking)",
      "Verify correct input and output points (splitters, etc.)",
      "Analyse and power (ensure no open ports)",
      "Verify pole owner",
      "Verify pole position (Front / Rear)",
      "Check access issue (Yes / No)",
      "Confirm build state is AS-BUILT",
      "Boundary association"
    ]
  },

  /* ===== ROUTE PHASE – BEFORE PRINT ===== */
  {
    title: "ROUTE PHASE – BEFORE PRINT",
    items: [
      "Take BEFORE PRINT"
    ]
  },

  /* ===== MERGE WORKSPACE – ROUTE ===== */
  {
    title: "MERGE WORKSPACE – ROUTE",
    items: [
      "Merge workspace in MQMS",
      "Verify module details are all zero",
      "Submit MQMS"
    ]
  },

  /* ===== COAX PHASE ===== */
  {
    title: "COAX PHASE",
    items: [
      "Start clock in COAX",
      "Area catalogue design (Select HUB from MQMS)",
      "Verify equipment converted to correct spec file",
      "Start analysis from actives at E.O.L",
      "Remove equalizer and add splice block except E.O.L",
      "Fix caution tap after removing equalizer",
      "Convert all caution taps to fudge",
      "Fix red taps to normal or convert to fudge",
      "Add booster or actives if required",
      "Analyse and power (no caution taps)",
      "Ensure no orange taps remain in fudge",
      "Ensure no caution for amplifiers",
      "Boundary association"
    ]
  },

  /* ===== COAX PHASE – AFTER PRINT ===== */
  {
    title: "COAX PHASE – AFTER PRINT",
    items: [
      "Take AFTER PRINT"
    ]
  },

  /* ===== MERGE WORKSPACE – COAX ===== */
  {
    title: "MERGE WORKSPACE – COAX",
    items: [
      "Merge workspace in MQMS",
      "Enter footage (aerial, underground, riser)",
      "Enter house count (aerial & underground)",
      "Submit MQMS"
    ]
  },

  /* ===== FIBER PHASE ===== */
  {
    title: "FIBER PHASE",
    items: [
      "Start clock in FIBER",
      "Connect pigtail to node and splice can",
      "Run fiber trace",
      "Take BEFORE PRINT",
      "Upgrade pigtail to 6ct if below 6ct",
      "NODE: Connect FWD & RTN to pigtail",
      "NODE: Link address to FWD & RTN",
      "SPLICE CAN: Add internal DEMUX (DWDM CH20–CH23)",
      "Connect 4 fibers from pigtail to DWDM",
      "Connect common to HUB",
      "Add circuit and sub-circuits",
      "Draw PRISM boundary around node",
      "Run fiber trace again"
    ]
  },

  /* ===== FIBER PHASE – AFTER PRINT ===== */
  {
    title: "FIBER PHASE – AFTER PRINT",
    items: [
      "Take AFTER PRINT"
    ]
  },

  /* ===== MERGE WORKSPACE – FIBER ===== */
  {
    title: "MERGE WORKSPACE – FIBER",
    items: [
      "Merge workspace in MQMS",
      "Verify module details are all zero",
      "Submit MQMS"
    ]
  },

  /* ===== PACKAGE PHASE ===== */
  {
    title: "PACKAGE PHASE",
    items: [
      "Start clock in PACKAGE",
      "Take prints and make callouts",
      "Remove tags from PDFs",
      "COAX: BEFORE PRINT",
      "COAX: AFTER PRINT",
      "COAX: BOM",
      "COAX: HAF",
      "FIBER: BEFORE PRINT",
      "FIBER: AFTER PRINT",
      "FIBER: BOM",
      "FIBER: HAF",
      "Generate splice report (schematic)",
      "Run fiber trace",
      "Generate affected traffic report",
      "Generate trace report",
      "Bookmark trace view",
      "Capture overview from code edit"
    ]
  }
];

let startTime, timerInterval;
const checklistDiv = document.getElementById("checklist");
const progressBar = document.getElementById("progressBar");
const progressText = document.getElementById("progressText");
const timerEl = document.getElementById("timer");
const toggleAllBtn = document.getElementById("toggleAllBtn");
const nextBtn = document.getElementById("nextBtn");

/* ========= TIMER ========= */
function startTimer() {
  startTime = Date.now();
  timerInterval = setInterval(() => {
    const diff = Date.now() - startTime;
    const h = String(Math.floor(diff/3600000)).padStart(2,"0");
    const m = String(Math.floor(diff/60000)%60).padStart(2,"0");
    const s = String(Math.floor(diff/1000)%60).padStart(2,"0");
    timerEl.innerText = `${h}:${m}:${s}`;
  },1000);
}

/* ========= RENDER ========= */
function renderChecklist() {
  checklistDiv.innerHTML = "";
  checklistData.forEach((sec,i)=>{
    let html = `
      <div class="card mb-3 shadow-sm">
        <div class="card-body">
          <div class="d-flex justify-content-between mb-2">
            <h5>${sec.title}</h5>
            <button class="btn btn-sm btn-outline-primary"
              onclick="toggleSection(${i},this)">Select All</button>
          </div>`;
    sec.items.forEach((item,j)=>{
      html+=`
        <div class="form-check">
          <input class="form-check-input sec-${i}" type="checkbox" onchange="updateProgress()">
          <label class="form-check-label">${item}</label>
        </div>`;
    });
    html+="</div></div>";
    checklistDiv.innerHTML+=html;
  });
  startTimer();
  updateProgress();
}

function toggleSection(i,btn){
  const boxes=document.querySelectorAll(`.sec-${i}`);
  const all=[...boxes].every(b=>b.checked);
  boxes.forEach(b=>b.checked=!all);
  btn.innerText=all?"Select All":"Unselect All";
  updateProgress();
}

function updateProgress(){
  const boxes=document.querySelectorAll("input[type=checkbox]");
  const done=[...boxes].filter(b=>b.checked).length;
  const p=Math.round((done/boxes.length)*100)||0;
  progressBar.style.width=p+"%";
  progressText.innerText=p+"%";
  nextBtn.disabled=p!==100;
}

toggleAllBtn.onclick=()=>{
  const boxes=document.querySelectorAll("input[type=checkbox]");
  const all=[...boxes].every(b=>b.checked);
  boxes.forEach(b=>b.checked=!all);
  updateProgress();
};

function resetAll(){ renderChecklist(); }

renderChecklist();
</script>
</body>
</html>
